<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>CricScore Pro - Live Center</title>
    
    <!-- App Icon -->
    <link rel="icon" type="image/png" href="https://i.postimg.cc/FRMTxVb2/app-icon-android.png">

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Fonts: 'Inter' for UI, 'Oswald' for Numbers, 'Hind Siliguri' for Bengali -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Oswald:wght@400;500;700&family=Hind+Siliguri:wght@400;500;600;700&display=swap" rel="stylesheet">

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Canvas Confetti for Celebrations -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        display: ['Oswald', 'sans-serif'],
                        bengali: ['Hind Siliguri', 'sans-serif'],
                    },
                    colors: {
                        app: {
                            bg: '#0f172a', // Slate 900
                            card: '#1e293b', // Slate 800
                            primary: '#10b981', // Emerald 500
                            accent: '#6366f1', // Indigo 500
                            danger: '#ef4444',
                        }
                    },
                    animation: {
                        'float': 'float 6s ease-in-out infinite',
                        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'slide-up': 'slideUp 0.4s ease-out forwards',
                        'pop-in': 'popIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards',
                    },
                    keyframes: {
                        float: {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-10px)' },
                        },
                        slideUp: {
                            '0%': { transform: 'translateY(20px)', opacity: '0' },
                            '100%': { transform: 'translateY(0)', opacity: '1' },
                        },
                        popIn: {
                            '0%': { transform: 'scale(0.8)', opacity: '0' },
                            '100%': { transform: 'scale(1)', opacity: '1' },
                        }
                    }
                }
            }
        }
    </script>

    <style>
        /* Modern Scrollbar */
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
        .dark ::-webkit-scrollbar-thumb { background: #334155; }

        /* Glassmorphism Utilities */
        .glass {
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        .dark .glass {
            background: rgba(30, 41, 59, 0.7); /* Slate 800 with opacity */
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .glass-card {
            background: linear-gradient(135deg, rgba(255,255,255,1) 0%, rgba(248,250,252,1) 100%);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.05), 0 4px 6px -2px rgba(0, 0, 0, 0.025);
        }
        .dark .glass-card {
            background: linear-gradient(135deg, rgba(30,41,59,1) 0%, rgba(15,23,42,1) 100%);
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.3);
        }

        /* Bottom Nav Active State indicator */
        .nav-item.active i { color: #10b981; transform: translateY(-2px); }
        .nav-item.active span { color: #10b981; font-weight: 600; }
        .nav-item i { transition: all 0.3s ease; }
        
        /* Desktop Nav Active State */
        .desktop-nav-item.active { color: #10b981; background-color: rgba(16, 185, 129, 0.1); }

        /* View Transitions */
        .view-section { animation: fadeIn 0.4s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* Score Ball */
        .ball-circle {
            width: 32px; height: 32px;
            display: flex; align-items: center; justify-content: center;
            border-radius: 50%; font-size: 0.75rem; font-weight: 700;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        /* Toast Animation */
        .toast-enter { animation: slideInRight 0.3s cubic-bezier(0.68, -0.55, 0.27, 1.55) forwards; }
        .toast-exit { animation: fadeOutRight 0.3s forwards; }
        @keyframes slideInRight { from { transform: translateX(100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
        @keyframes fadeOutRight { to { transform: translateX(100%); opacity: 0; } }

        /* Event Overlay Text */
        .big-impact-text {
            font-family: 'Oswald', sans-serif;
            font-size: 8rem; line-height: 1; font-weight: 700;
            text-shadow: 0 10px 30px rgba(0,0,0,0.5);
            background: linear-gradient(to bottom, #fff 0%, #cbd5e1 100%);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            transform: scale(0); transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .active .big-impact-text { transform: scale(1); }
        
        .hide-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .hide-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        /* --- NEW ANIMATION CSS --- */
        .flying-run-indicator {
            position: fixed;
            z-index: 9999;
            font-family: 'Oswald', sans-serif;
            font-weight: bold;
            pointer-events: none;
            text-shadow: 0 4px 15px rgba(0,0,0,0.3);
            will-change: transform, opacity;
            user-select: none;
        }
        
        @keyframes scorePulseImpact {
            0% { transform: scale(1); filter: brightness(1); }
            50% { transform: scale(1.4); filter: brightness(1.3); text-shadow: 0 0 20px rgba(16, 185, 129, 0.6); color: #10b981; }
            100% { transform: scale(1); filter: brightness(1); }
        }
        
        .score-impact-anim {
            animation: scorePulseImpact 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        
        /* Grid transition helper */
        .match-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1.5rem;
        }
        @media (min-width: 768px) {
            .match-grid { grid-template-columns: repeat(2, 1fr); }
        }
        @media (min-width: 1024px) {
            .match-grid { grid-template-columns: repeat(3, 1fr); }
        }
    </style>
</head>
<body class="bg-gray-50 dark:bg-app-bg text-gray-800 dark:text-gray-100 min-h-screen transition-colors duration-300 font-sans pb-24 lg:pb-0 selection:bg-green-500 selection:text-white">

    <!-- Global Loader -->
    <div id="globalLoader" class="fixed inset-0 z-[9999] bg-white dark:bg-app-bg flex flex-col items-center justify-center transition-opacity duration-500">
        <div class="relative w-24 h-24 mb-4">
            <div class="absolute inset-0 border-4 border-gray-200 dark:border-gray-800 rounded-full"></div>
            <div class="absolute inset-0 border-4 border-green-500 rounded-full border-t-transparent animate-spin"></div>
            <img src="https://i.postimg.cc/FRMTxVb2/app-icon-android.png" class="absolute inset-2 w-20 h-20 rounded-full object-cover p-1">
        </div>
        <h1 class="text-2xl font-display font-bold tracking-widest text-transparent bg-clip-text bg-gradient-to-r from-green-500 to-emerald-700">CRICSCORE</h1>
        <p class="text-xs text-gray-400 mt-2 uppercase tracking-widest">Loading Live Data...</p>
    </div>

    <!-- Celebration Overlay (Confetti & Big Text) -->
    <div id="eventOverlay" class="fixed inset-0 z-[5000] pointer-events-none flex items-center justify-center bg-black/80 opacity-0 transition-opacity duration-300 backdrop-blur-sm">
        <div class="text-center transform scale-90 transition-transform duration-300" id="eventContent">
            <div id="eventText" class="big-impact-text">6</div>
            <div id="eventSub" class="text-2xl font-bold text-white uppercase tracking-[0.5em] mt-4 opacity-0 transition-opacity duration-500 delay-100">MAXIMUM</div>
        </div>
    </div>

    <!-- Toast Notifications Container -->
    <div id="toastContainer" class="fixed top-4 left-4 right-4 z-[6000] flex flex-col gap-2 pointer-events-none sm:left-auto sm:w-96 sm:right-4"></div>

    <!-- Header -->
    <header class="fixed top-0 left-0 w-full z-40 glass shadow-sm transition-all duration-300">
        <div class="w-full max-w-7xl mx-auto px-4 h-16 flex items-center justify-between">
            <div class="flex items-center gap-3 cursor-pointer" onclick="switchView('live')">
                <div class="relative">
                    <img src="https://i.postimg.cc/FRMTxVb2/app-icon-android.png" class="w-9 h-9 rounded-xl shadow-lg border border-white/10">
                    <div class="absolute -bottom-1 -right-1 w-3 h-3 bg-green-500 rounded-full border-2 border-white dark:border-gray-900 animate-pulse"></div>
                </div>
                <span class="font-display font-bold text-xl tracking-tight text-gray-800 dark:text-white">CricScore<span class="text-green-500">.</span></span>
            </div>

            <!-- Desktop Navigation -->
            <div class="hidden lg:flex items-center gap-1 bg-gray-100 dark:bg-gray-800/50 p-1 rounded-full border border-gray-200 dark:border-gray-700">
                <button onclick="switchView('live')" class="desktop-nav-item active px-4 py-1.5 rounded-full text-sm font-medium text-gray-600 dark:text-gray-300 hover:text-green-600 transition-colors" data-target="live">Matches</button>
                <button onclick="switchView('tournaments')" class="desktop-nav-item px-4 py-1.5 rounded-full text-sm font-medium text-gray-600 dark:text-gray-300 hover:text-green-600 transition-colors" data-target="tournaments">Leagues</button>
                <button onclick="switchView('players')" class="desktop-nav-item px-4 py-1.5 rounded-full text-sm font-medium text-gray-600 dark:text-gray-300 hover:text-green-600 transition-colors" data-target="players">Stats</button>
            </div>

            <div class="flex items-center gap-2">
                <button onclick="toggleTheme()" class="w-10 h-10 rounded-full flex items-center justify-center bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-yellow-400 hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors">
                    <i class="fas fa-moon dark:hidden"></i>
                    <i class="fas fa-sun hidden dark:block"></i>
                </button>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main id="mainContainer" class="pt-24 px-4 w-full max-w-7xl mx-auto min-h-screen">
        
        <!-- Live Matches View -->
        <div id="liveView" class="view-section">
            <div class="flex justify-between items-end mb-6">
                <div>
                    <h2 class="text-2xl font-bold font-display text-gray-800 dark:text-white">Live Matches</h2>
                    <p class="text-sm text-gray-500 dark:text-gray-400">Real-time scores & updates</p>
                </div>
                <span class="text-xs font-bold bg-red-500/10 text-red-500 px-3 py-1 rounded-full border border-red-500/20 flex items-center gap-1">
                    <span class="w-2 h-2 bg-red-500 rounded-full animate-pulse"></span> LIVE
                </span>
            </div>
            
            <div id="matchesList" class="match-grid pb-20 lg:pb-8">
                <!-- Loading Skeleton -->
                <div class="glass-card rounded-2xl p-4 animate-pulse">
                    <div class="h-4 bg-gray-200 dark:bg-gray-700 rounded w-1/4 mb-4"></div>
                    <div class="flex justify-between items-center mb-6">
                        <div class="h-10 w-10 bg-gray-200 dark:bg-gray-700 rounded-full"></div>
                        <div class="h-6 bg-gray-200 dark:bg-gray-700 rounded w-1/3"></div>
                        <div class="h-10 w-10 bg-gray-200 dark:bg-gray-700 rounded-full"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tournaments View -->
        <div id="tournamentsView" class="view-section hidden">
            <h2 class="text-2xl font-bold font-display mb-6 text-gray-800 dark:text-white">Tournaments</h2>
            <div class="glass-card rounded-2xl p-8 text-center border-l-4 border-yellow-500 max-w-2xl mx-auto">
                <div class="w-16 h-16 bg-yellow-100 dark:bg-yellow-900/30 rounded-full flex items-center justify-center mx-auto mb-4 text-yellow-600 dark:text-yellow-400 text-2xl">
                    <i class="fas fa-trophy"></i>
                </div>
                <h3 class="font-bold text-lg mb-2">No Active Tournaments</h3>
                <p class="text-sm text-gray-500">Check back later for upcoming leagues.</p>
            </div>
        </div>

        <!-- Players View -->
        <div id="playersView" class="view-section hidden">
            <h2 class="text-2xl font-bold font-display mb-4 text-gray-800 dark:text-white">Player Stats</h2>
            <div class="relative mb-6 max-w-md">
                <i class="fas fa-search absolute left-4 top-1/2 -translate-y-1/2 text-gray-400"></i>
                <input type="text" id="playerSearch" onkeyup="filterPlayers()" placeholder="Search players..." 
                    class="w-full pl-10 pr-4 py-3 bg-white dark:bg-gray-800 border-none rounded-xl shadow-sm focus:ring-2 focus:ring-green-500 outline-none transition text-sm">
            </div>
            <div id="playersListContainer" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 pb-20 lg:pb-8"></div>
        </div>

        <!-- Match Detail View -->
        <div id="matchDetailView" class="view-section hidden pb-24 lg:pb-8">
            <div class="max-w-4xl mx-auto">
                <!-- Back Button Header override -->
                <button onclick="switchView('live')" class="mb-4 flex items-center text-sm font-medium text-gray-500 hover:text-green-500 transition">
                    <i class="fas fa-arrow-left mr-2"></i> Back to Matches
                </button>

                <!-- Main Score Card -->
                <div class="glass-card rounded-3xl overflow-hidden relative mb-6 border border-gray-100 dark:border-gray-700 shadow-xl">
                    <!-- Background Decoration -->
                    <div class="absolute top-0 right-0 w-64 h-64 bg-green-500/10 rounded-full blur-3xl -mr-16 -mt-16 pointer-events-none"></div>
                    
                    <div class="p-6 relative z-10">
                        <div class="flex justify-between items-start mb-4">
                            <span id="matchStatusBadge" class="bg-red-500 text-white text-[10px] px-2.5 py-1 rounded-md uppercase font-bold tracking-wider shadow-sm animate-pulse">LIVE</span>
                            <div class="text-right">
                                 <span id="matchTournamentName" class="text-xs font-bold text-gray-500 uppercase tracking-wide">Tournament</span>
                            </div>
                        </div>

                        <div class="flex items-center justify-between mt-2">
                            <div class="text-center w-[40%]">
                                <h3 id="teamAName" class="font-bold text-lg sm:text-xl font-display leading-tight text-gray-800 dark:text-white truncate">Team A</h3>
                                <div class="mt-2 text-3xl sm:text-4xl lg:text-5xl font-display font-bold text-gray-900 dark:text-gray-100 tracking-tight transition-transform duration-150" id="teamAScore">0/0</div>
                                <div class="text-sm font-medium text-gray-500 mt-1" id="teamAOvers">0.0 ov</div>
                            </div>
                            
                            <div class="text-center w-[20%] flex flex-col items-center justify-center">
                                <div class="w-8 h-8 rounded-full bg-gray-100 dark:bg-gray-700 flex items-center justify-center text-xs font-bold text-gray-400">VS</div>
                            </div>

                            <div class="text-center w-[40%]">
                                <h3 id="teamBName" class="font-bold text-lg sm:text-xl font-display leading-tight text-gray-800 dark:text-white truncate">Team B</h3>
                                <div class="mt-2 text-3xl sm:text-4xl lg:text-5xl font-display font-bold text-gray-900 dark:text-gray-100 tracking-tight transition-transform duration-150" id="teamBScore">0/0</div>
                                <div class="text-sm font-medium text-gray-500 mt-1" id="teamBOvers">0.0 ov</div>
                            </div>
                        </div>

                        <div class="mt-4 flex flex-col items-center gap-2">
                             <!-- Current Partnership Display -->
                            <div id="partnershipDisplay" class="bg-gray-100 dark:bg-gray-800 px-3 py-1 rounded-full text-xs font-bold text-gray-600 dark:text-gray-300 hidden">
                                <i class="fas fa-handshake mr-1 text-green-500"></i> Partnership: <span id="partnerRuns">0</span> (<span id="partnerBalls">0</span>)
                            </div>

                            <div class="pt-2 border-t border-gray-100 dark:border-gray-700/50 flex flex-wrap justify-center gap-3 text-xs font-bold w-full">
                                <span id="matchResult" class="text-green-600 dark:text-green-400">Match Started</span>
                                <!-- Target ID kept, default hidden -->
                                <span id="matchTargetDisplay" class="hidden text-blue-500 bg-blue-50 dark:bg-blue-900/20 px-2 py-0.5 rounded">Target: 0</span>
                            </div>
                        </div>
                    </div>

                    <!-- Win Probability Bar -->
                    <div id="winProbContainer" class="bg-gray-100 dark:bg-gray-800/50 h-1.5 w-full flex relative hidden mt-2 rounded-full overflow-hidden">
                        <div id="winBarA" class="h-full bg-blue-500 transition-all duration-1000" style="width: 50%"></div>
                        <div id="winBarB" class="h-full bg-orange-500 transition-all duration-1000" style="width: 50%"></div>
                        <!-- Center Marker -->
                        <div class="absolute top-0 left-1/2 -translate-x-1/2 w-0.5 h-full bg-white dark:bg-gray-900 z-10"></div>
                    </div>
                </div>

                <!-- Recent Balls (Horizontal Scroll) -->
                <div class="mb-6">
                    <h4 class="text-xs font-bold text-gray-400 uppercase tracking-widest mb-3 ml-1">Recent Deliveries</h4>
                    <div id="recentBallsContainer" class="flex gap-2 overflow-x-auto pb-4 hide-scrollbar snap-x min-h-[40px]">
                        <!-- Balls injected by JS -->
                    </div>
                </div>

                <!-- Tabs: Scorecard / Commentary -->
                <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-100 dark:border-gray-700 overflow-hidden">
                    <div class="flex border-b border-gray-100 dark:border-gray-700">
                        <button onclick="switchMainTab('scorecard')" id="tab-scorecard" class="flex-1 py-4 text-sm font-bold text-green-500 border-b-2 border-green-500 bg-green-50/50 dark:bg-green-900/10 transition-colors">SCORECARD</button>
                        <button onclick="switchMainTab('commentary')" id="tab-commentary" class="flex-1 py-4 text-sm font-bold text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors">COMMENTARY</button>
                        <button onclick="switchMainTab('analytics')" id="tab-analytics" class="flex-1 py-4 text-sm font-bold text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors">ANALYTICS</button>
                    </div>

                    <div class="p-0 min-h-[300px]">
                        <!-- Scorecard Tab -->
                        <div id="content-scorecard" class="tab-content animate-pop-in">
                            <div class="flex bg-gray-50 dark:bg-gray-700/30 p-1 m-3 rounded-lg">
                                <button onclick="switchLiveTab('teamA')" id="btn-teamA" class="flex-1 py-1.5 text-xs font-bold rounded-md bg-white dark:bg-gray-600 shadow-sm text-gray-800 dark:text-white transition-all">Team A</button>
                                <button onclick="switchLiveTab('teamB')" id="btn-teamB" class="flex-1 py-1.5 text-xs font-bold rounded-md text-gray-500 hover:bg-gray-200 dark:hover:bg-gray-600 transition-all">Team B</button>
                            </div>
                            <div id="live-content-teamA" class="p-3"></div>
                            <div id="live-content-teamB" class="p-3 hidden"></div>
                        </div>

                        <!-- Commentary Tab (Bengali) -->
                        <div id="content-commentary" class="tab-content hidden animate-pop-in p-4 font-bengali">
                            <div id="commFeed" class="space-y-4"></div>
                        </div>

                        <!-- Analytics Tab -->
                        <div id="content-analytics" class="tab-content hidden animate-pop-in p-4">
                            <!-- Projected Score Card -->
                            <div class="bg-indigo-50 dark:bg-indigo-900/20 p-4 rounded-xl mb-4 border border-indigo-100 dark:border-indigo-500/30">
                                 <h4 class="text-xs font-bold uppercase text-indigo-500 mb-2">Projected Score (সম্ভাব্য স্কোর)</h4>
                                 <div class="flex justify-between items-center">
                                     <div>
                                         <div class="text-xs text-gray-500">Current Run Rate</div>
                                         <div class="text-xl font-bold font-display" id="anaCRR">0.00</div>
                                     </div>
                                     <div class="text-right">
                                         <div class="text-xs text-gray-500">Projected (20 ov)</div>
                                         <div class="text-2xl font-bold font-display text-indigo-600 dark:text-indigo-400" id="anaProj">0</div>
                                     </div>
                                 </div>
                            </div>

                            <div class="bg-gray-50 dark:bg-gray-900/50 p-4 rounded-xl mb-4">
                                <h4 class="text-xs font-bold uppercase text-gray-400 mb-4 text-center">Run Rate Comparison (Worm)</h4>
                                <div class="h-48 w-full"><canvas id="wormChart"></canvas></div>
                            </div>

                            <div class="bg-gray-50 dark:bg-gray-900/50 p-4 rounded-xl mb-4">
                                <h4 class="text-xs font-bold uppercase text-gray-400 mb-4 text-center">Runs Per Over (Bar)</h4>
                                <div class="h-48 w-full"><canvas id="barChart"></canvas></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Bottom Navigation Bar (Mobile Only) -->
    <nav class="fixed bottom-0 left-0 w-full bg-white/90 dark:bg-gray-900/90 backdrop-blur-lg border-t border-gray-200 dark:border-gray-800 z-50 pb-safe lg:hidden">
        <div class="max-w-md mx-auto flex justify-around items-center h-16">
            <button onclick="switchView('live')" class="nav-item active flex flex-col items-center justify-center w-full h-full text-gray-400 hover:text-green-500 transition-colors" data-target="live">
                <i class="fas fa-tower-broadcast text-lg mb-1"></i>
                <span class="text-[10px]">Matches</span>
            </button>
            <button onclick="switchView('tournaments')" class="nav-item flex flex-col items-center justify-center w-full h-full text-gray-400 hover:text-green-500 transition-colors" data-target="tournaments">
                <i class="fas fa-trophy text-lg mb-1"></i>
                <span class="text-[10px]">Leagues</span>
            </button>
            <button onclick="switchView('players')" class="nav-item flex flex-col items-center justify-center w-full h-full text-gray-400 hover:text-green-500 transition-colors" data-target="players">
                <i class="fas fa-users text-lg mb-1"></i>
                <span class="text-[10px]">Stats</span>
            </button>
        </div>
    </nav>

    <!-- Player Profile Modal -->
    <div id="playerModal" class="invisible fixed inset-0 z-[7000] pointer-events-none flex items-end sm:items-center justify-center sm:p-4">
        <div class="absolute inset-0 bg-black/60 backdrop-blur-sm opacity-0 transition-opacity duration-300" id="modalOverlay" onclick="closePlayerModal()"></div>
        <div class="bg-white dark:bg-gray-800 w-full sm:max-w-md sm:rounded-2xl rounded-t-2xl shadow-2xl transform translate-y-full transition-transform duration-300 overflow-hidden flex flex-col max-h-[85vh]" id="modalContent">
            
            <!-- Modal Header -->
            <div class="relative h-32 bg-gradient-to-r from-green-500 to-emerald-700 flex items-center justify-center">
                <button onclick="closePlayerModal()" class="absolute top-4 right-4 text-white/80 hover:text-white bg-black/10 hover:bg-black/20 rounded-full w-8 h-8 flex items-center justify-center transition"><i class="fas fa-times"></i></button>
                <div class="absolute -bottom-10 left-1/2 -translate-x-1/2">
                    <div id="modalAvatar" class="w-24 h-24 rounded-full border-4 border-white dark:border-gray-800 bg-gray-200 flex items-center justify-center text-2xl font-bold text-gray-400 shadow-md overflow-hidden"></div>
                </div>
            </div>

            <!-- Modal Body -->
            <div class="pt-12 p-6 overflow-y-auto">
                <div class="text-center mb-6">
                    <h2 id="modalName" class="text-2xl font-bold font-display text-gray-800 dark:text-white">Player Name</h2>
                    <span id="modalId" class="text-xs font-mono text-gray-400 bg-gray-100 dark:bg-gray-700 px-2 py-0.5 rounded">ID: --</span>
                </div>

                <div class="grid grid-cols-2 gap-4">
                    <!-- Batting Card -->
                    <div class="bg-gray-50 dark:bg-gray-700/30 rounded-xl p-4 border border-gray-100 dark:border-gray-700">
                        <div class="flex items-center gap-2 mb-3 text-emerald-500 font-bold text-xs uppercase tracking-wider border-b border-gray-200 dark:border-gray-600 pb-2">
                            <i class="fas fa-baseball-bat-ball"></i> Batting
                        </div>
                        <div class="space-y-2 text-sm">
                            <div class="flex justify-between"><span class="text-gray-500">Runs</span> <span id="mRuns" class="font-bold dark:text-gray-200">0</span></div>
                            <div class="flex justify-between"><span class="text-gray-500">Balls</span> <span id="mBalls" class="font-bold dark:text-gray-200">0</span></div>
                            <div class="flex justify-between"><span class="text-gray-500">Highest</span> <span id="mHS" class="font-bold dark:text-gray-200">0</span></div>
                            <div class="flex justify-between"><span class="text-gray-500">SR</span> <span id="mSR" class="font-bold text-emerald-500">0.00</span></div>
                        </div>
                    </div>
                    <!-- Bowling Card -->
                    <div class="bg-gray-50 dark:bg-gray-700/30 rounded-xl p-4 border border-gray-100 dark:border-gray-700">
                        <div class="flex items-center gap-2 mb-3 text-indigo-500 font-bold text-xs uppercase tracking-wider border-b border-gray-200 dark:border-gray-600 pb-2">
                            <i class="fas fa-bullseye"></i> Bowling
                        </div>
                        <div class="space-y-2 text-sm">
                            <div class="flex justify-between"><span class="text-gray-500">Wickets</span> <span id="mWickets" class="font-bold dark:text-gray-200">0</span></div>
                            <div class="flex justify-between"><span class="text-gray-500">Overs</span> <span id="mOvers" class="font-bold dark:text-gray-200">0.0</span></div>
                            <div class="flex justify-between"><span class="text-gray-500">Economy</span> <span id="mEco" class="font-bold text-red-500">0.00</span></div>
                            <div class="flex justify-between"><span class="text-gray-500">Best</span> <span id="mBest" class="font-bold dark:text-gray-200">0/0</span></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- JS Module -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, collection, doc, onSnapshot, query, orderBy, getDocs } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // FIREBASE CONFIG
        const firebaseConfig = {
          apiKey: "AIzaSyDUP-ot4yX5Bg3GNpfDrZ6NOL8c5YFdoyo",
          authDomain: "live-score-49270.firebaseapp.com",
          databaseURL: "https://live-score-49270-default-rtdb.firebaseio.com",
          projectId: "live-score-49270",
          storageBucket: "live-score-49270.firebasestorage.app",
          messagingSenderId: "992482589674",
          appId: "1:992482589674:web:11d1e85f7c5473ed841093"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        const appId = 'cricket-app-v1';
        
        // --- SOUND EFFECTS ---
        const batHitSound = new Audio('https://cdn.pixabay.com/audio/2022/03/10/audio_c8c8a73467.mp3');

        let currentMatchId = null; 
        let currentMatchUnsubscribe = null;
        let matchesListUnsubscribe = null; 
        let currentMatchState = null;
        let wormChartInstance = null;
        let barChartInstance = null;
        let lastProcessedBallId = 0;
        let isViewJustOpened = false; // Flag to prevent sound on initial load

        const getCollPath = (name) => `artifacts/${appId}/public/data/${name}`;

        // INIT
        async function initApp() {
            // Check Theme Preference
            if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }

            try {
                await signInAnonymously(auth);
                // Hide Loader
                const loader = document.getElementById('globalLoader');
                loader.style.opacity = '0';
                setTimeout(() => loader.style.display = 'none', 500);
                
                switchView('live');
            } catch (error) {
                console.error("Auth Error:", error);
                document.getElementById('globalLoader').innerHTML = `<div class="text-red-500 text-center p-4">Connection Failed.<br><span class="text-xs text-gray-400">Please refresh</span></div>`;
            }
        }
        initApp();

        // UI HELPERS
        window.toggleTheme = () => {
            document.documentElement.classList.toggle('dark');
            localStorage.theme = document.documentElement.classList.contains('dark') ? 'dark' : 'light';
        };

        window.switchView = (viewName) => {
            // Cleanup when leaving match detail
            if(viewName !== 'matchDetail') {
                currentMatchId = null;
                if(currentMatchUnsubscribe) {
                    currentMatchUnsubscribe();
                    currentMatchUnsubscribe = null;
                }
            }

            // Hide all views
            document.querySelectorAll('.view-section').forEach(el => el.classList.add('hidden'));
            // Show target
            document.getElementById(`${viewName}View`).classList.remove('hidden');
            
            // Update Bottom Nav
            document.querySelectorAll('.nav-item').forEach(btn => btn.classList.remove('active'));
            const activeBtn = document.querySelector(`.nav-item[data-target="${viewName}"]`);
            if(activeBtn) activeBtn.classList.add('active');

            // Update Desktop Nav
            document.querySelectorAll('.desktop-nav-item').forEach(btn => btn.classList.remove('active'));
            const activeDesktopBtn = document.querySelector(`.desktop-nav-item[data-target="${viewName}"]`);
            if(activeDesktopBtn) activeDesktopBtn.classList.add('active');

            // Scroll to top
            window.scrollTo(0, 0);

            // Load data
            if(viewName === 'live') loadMatches();
            if(viewName === 'players') loadAllPlayers();
        };

        window.switchMainTab = (tab) => {
             document.querySelectorAll('.tab-content').forEach(el => el.classList.add('hidden'));
             document.getElementById(`content-${tab}`).classList.remove('hidden');
             
             // Update tab buttons styles
             const tabs = ['scorecard', 'commentary', 'analytics'];
             tabs.forEach(t => {
                 const btn = document.getElementById(`tab-${t}`);
                 if(t === tab) {
                    btn.className = "flex-1 py-4 text-sm font-bold text-green-500 border-b-2 border-green-500 bg-green-50/50 dark:bg-green-900/10 transition-colors";
                 } else {
                    btn.className = "flex-1 py-4 text-sm font-bold text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors";
                 }
             });

             if(tab === 'analytics' && currentMatchState) setTimeout(() => renderCharts(currentMatchState), 100);
        };

        // --- MATCHES LIST LOGIC ---
        function formatDateHeader(timestamp) {
            if (!timestamp) return 'Upcoming';
            const date = timestamp.toDate ? timestamp.toDate() : new Date(timestamp);
            const today = new Date();
            const yesterday = new Date();
            yesterday.setDate(today.getDate() - 1);
            
            if (date.toDateString() === today.toDateString()) return 'Today';
            if (date.toDateString() === yesterday.toDateString()) return 'Yesterday';
            return date.toLocaleDateString('en-US', { day: 'numeric', month: 'short', year: 'numeric' });
        }

        function formatTime(timestamp) {
            if (!timestamp) return '';
            const date = timestamp.toDate ? timestamp.toDate() : new Date(timestamp);
            return date.toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit', hour12: true });
        }

        function loadMatches() {
            if (matchesListUnsubscribe) matchesListUnsubscribe();
            const list = document.getElementById('matchesList');
            const q = query(collection(db, getCollPath('matches')), orderBy('createdAt', 'desc'));

            matchesListUnsubscribe = onSnapshot(q, (snapshot) => {
                list.innerHTML = '';
                if(snapshot.empty) {
                    list.innerHTML = `
                        <div class="col-span-full text-center py-12">
                            <div class="bg-gray-100 dark:bg-gray-800 w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-4">
                                <i class="fas fa-baseball-bat-ball text-3xl text-gray-400"></i>
                            </div>
                            <h3 class="text-gray-500 font-medium">No matches live right now</h3>
                        </div>`;
                    return;
                }

                let lastDateGroup = '';

                snapshot.forEach(doc => {
                    const m = {id: doc.id, ...doc.data()};
                    const dateGroup = formatDateHeader(m.createdAt || Date.now());

                    if (dateGroup !== lastDateGroup) {
                        list.innerHTML += `<div class="col-span-full text-xs font-bold text-gray-400 uppercase tracking-widest mt-6 mb-3 ml-1 border-b border-gray-100 dark:border-gray-700 pb-1 flex justify-between items-center">
                            <span>${dateGroup}</span>
                            <span class="text-[10px] font-normal opacity-50"><i class="far fa-calendar-alt"></i></span>
                        </div>`;
                        lastDateGroup = dateGroup;
                    }

                    list.innerHTML += renderMatchCard(m);
                });
            });
        }

        function renderMatchCard(match) {
            const isLive = match.status === 'live';
            const isFinished = !!match.result || match.status === 'completed';
            
            const state = calculateMatchState(match); 
            const i1 = state.innings[1];
            const i2 = state.innings[2];
            
            const scoreA = `${i1.runs}/${i1.wickets}`;
            const oversA = `${i1.overs}.${i1.balls}`;
            const scoreB = `${i2.runs}/${i2.wickets}`;
            const oversB = `${i2.overs}.${i2.balls}`;

            // Status Badge Logic
            let statusBadge = '';
            let timeBadge = '';

            if (isLive) {
                statusBadge = `<span class="text-[10px] font-bold text-white bg-red-500 px-2.5 py-1 rounded-full flex items-center gap-1 shadow-sm">
                    <span class="w-1.5 h-1.5 rounded-full bg-white animate-pulse"></span> LIVE
                </span>`;
            } else if (isFinished) {
                statusBadge = `<span class="text-[10px] font-bold text-gray-500 bg-gray-200 dark:bg-gray-700 px-2.5 py-1 rounded-full">
                    FINISHED
                </span>`;
            } else {
                const timeStr = formatTime(match.createdAt || Date.now());
                timeBadge = `<span class="ml-2 text-[10px] font-bold text-gray-500 dark:text-gray-400"><i class="far fa-clock mr-1"></i>${timeStr}</span>`;
            }

            // Footer / Result Logic
            let footerContent = '';
            if (isLive) {
                footerContent = `<span class="text-green-600 dark:text-green-400 font-bold animate-pulse"><i class="fas fa-circle text-[8px] mr-1"></i> খেলা চলছে - দেখতে ট্যাপ করুন</span>`;
            } else if (match.result) {
                footerContent = `<span class="text-indigo-600 dark:text-indigo-400 font-bold bg-indigo-50 dark:bg-indigo-900/30 px-3 py-1 rounded-lg w-full text-center block">${match.result}</span>`;
            } else {
                footerContent = `<span>ফলাফল শীঘ্রই আসছে</span>`;
            }

            // Team Initials
            const teamAInitial = match.teamAName ? match.teamAName.charAt(0) : 'A';
            const teamBInitial = match.teamBName ? match.teamBName.charAt(0) : 'B';

            return `
                <div class="group relative bg-white dark:bg-gray-800 rounded-3xl p-0 overflow-hidden shadow-lg border border-gray-100 dark:border-gray-700 transition-all duration-300 hover:shadow-xl hover:-translate-y-1 cursor-pointer" onclick="openMatch('${match.id}')">
                    <!-- Live Pulse Background (if live) -->
                    ${isLive ? '<div class="absolute top-0 right-0 w-32 h-32 bg-red-500/10 rounded-full blur-3xl -mr-16 -mt-16 animate-pulse pointer-events-none"></div>' : ''}
                    
                    <!-- Header -->
                    <div class="px-5 pt-4 flex justify-between items-center relative z-10">
                        <div class="flex items-center">
                            <span class="text-[10px] font-bold uppercase tracking-widest text-gray-400 bg-gray-100 dark:bg-gray-700/50 px-2 py-1 rounded-md max-w-[120px] truncate">${match.tournamentName || 'Friendly Match'}</span>
                            ${timeBadge}
                        </div>
                        ${statusBadge}
                    </div>

                    <!-- Teams & Scores -->
                    <div class="px-5 py-5 flex items-center justify-between relative z-10">
                         <!-- Team A -->
                         <div class="flex flex-col items-start w-[40%]">
                             <div class="flex items-center gap-2 mb-2 w-full">
                                 <div class="w-8 h-8 rounded-full bg-gradient-to-br from-emerald-400 to-green-600 flex items-center justify-center text-white font-bold text-xs shadow-md shrink-0">
                                    ${teamAInitial}
                                 </div>
                                 <h3 class="font-bold text-gray-800 dark:text-gray-100 text-sm leading-tight truncate w-full font-display">${match.teamAName}</h3>
                             </div>
                             <div class="pl-0">
                                 <p class="text-2xl font-bold font-display text-gray-900 dark:text-white tracking-tight whitespace-nowrap">${scoreA}</p>
                                 <p class="text-xs font-medium text-gray-500 mt-1.5 whitespace-nowrap pl-1">${oversA} ov</p>
                             </div>
                         </div>

                         <!-- VS / Status Middle -->
                         <div class="flex flex-col items-center justify-center w-[20%]">
                             <div class="w-8 h-8 rounded-full bg-gray-100 dark:bg-gray-700 flex items-center justify-center text-[10px] font-bold text-gray-400 border-2 border-white dark:border-gray-600 shadow-sm z-10">
                                VS
                             </div>
                         </div>

                         <!-- Team B -->
                         <div class="flex flex-col items-end w-[40%]">
                             <div class="flex items-center gap-2 mb-2 flex-row-reverse w-full">
                                 <div class="w-8 h-8 rounded-full bg-gradient-to-br from-indigo-400 to-blue-600 flex items-center justify-center text-white font-bold text-xs shadow-md shrink-0">
                                    ${teamBInitial}
                                 </div>
                                 <h3 class="font-bold text-gray-800 dark:text-gray-100 text-sm leading-tight truncate w-full text-right font-display">${match.teamBName}</h3>
                             </div>
                             <div class="pr-0 text-right">
                                 <p class="text-2xl font-bold font-display text-gray-900 dark:text-white tracking-tight whitespace-nowrap">${scoreB}</p>
                                 <p class="text-xs font-medium text-gray-500 mt-1.5 whitespace-nowrap pr-1">${oversB} ov</p>
                             </div>
                         </div>
                    </div>

                    <!-- Footer / Result -->
                    <div class="bg-gray-50 dark:bg-gray-700/30 px-5 py-3 border-t border-gray-100 dark:border-gray-700 flex items-center justify-center">
                         <div class="text-xs font-medium text-gray-500 dark:text-gray-400 w-full text-center">
                            ${footerContent}
                         </div>
                    </div>
                </div>
            `;
        }

        // --- MATCH DETAIL LOGIC ---
        window.openMatch = (matchId) => {
            currentMatchId = matchId; 
            lastProcessedBallId = 0;
            isViewJustOpened = true; 

            switchView('matchDetail');
            
            // --- Reset UI ---
            document.getElementById('teamAScore').innerText = '0/0';
            document.getElementById('teamBScore').innerText = '0/0';
            document.getElementById('teamAOvers').innerText = '0.0 ov';
            document.getElementById('teamBOvers').innerText = '0.0 ov';
            document.getElementById('teamAName').innerText = 'Loading...';
            document.getElementById('teamBName').innerText = 'Loading...';
            document.getElementById('matchStatusBadge').innerText = 'LOADING...';
            
            document.getElementById('matchTargetDisplay').classList.add('hidden');
            document.getElementById('partnershipDisplay').classList.add('hidden');
            document.getElementById('winProbContainer').classList.add('hidden');
            document.getElementById('matchResult').innerText = '';

            document.getElementById('recentBallsContainer').innerHTML = '';
            document.getElementById('commFeed').innerHTML = '';
            document.getElementById('live-content-teamA').innerHTML = '<div class="text-center p-4 text-gray-400">Loading Scorecard...</div>';
            document.getElementById('live-content-teamB').innerHTML = '';
            
            switchMainTab('scorecard');
            switchLiveTab('teamA');

            if(wormChartInstance) { wormChartInstance.destroy(); wormChartInstance = null; }
            if(barChartInstance) { barChartInstance.destroy(); barChartInstance = null; }
            
            if(currentMatchUnsubscribe) currentMatchUnsubscribe();
            
            currentMatchUnsubscribe = onSnapshot(doc(db, getCollPath('matches'), matchId), (docSnap) => {
                if (docSnap.exists()) {
                    const data = docSnap.data();
                    currentMatchState = calculateMatchState(data);
                    updateUI(data, currentMatchState);
                    
                    if (isViewJustOpened) isViewJustOpened = false;
                }
            });
        };

        function calculateMatchState(matchData) {
            const state = {
                innings: { 
                    1: { runs: 0, wickets: 0, overs: 0, balls: 0, history: [{over:0, runs:0}], wicketsData: [], runPerOver: [] }, 
                    2: { runs: 0, wickets: 0, overs: 0, balls: 0, history: [{over:0, runs:0}], wicketsData: [], runPerOver: [] } 
                },
                currentInnings: matchData.currentInnings || 1,
                batsmen: {}, bowlers: {}, 
                timeline: [],
                currentPartnership: { runs: 0, balls: 0 },
                totalLegalBalls: 0
            };

            let history = matchData.history || [];
            history = history.slice().sort((a, b) => (a.id || 0) - (b.id || 0));

            let lastWicketScore = 0;
            let lastWicketBalls = 0;
            let currentOverRuns = 0;
            
            history.forEach((ball, index) => {
                const inn = ball.innings;
                const s = state.innings[inn];
                if (!s) return;

                if(!state.batsmen[ball.strikerId]) state.batsmen[ball.strikerId] = { runs:0, balls:0, fours:0, sixes:0, out: null, name: ball.strikerName };
                if(!state.batsmen[ball.nonStrikerId]) state.batsmen[ball.nonStrikerId] = { runs:0, balls:0, fours:0, sixes:0, out: null, name: ball.nonStrikerName };
                if(!state.bowlers[ball.bowlerId]) state.bowlers[ball.bowlerId] = { balls:0, runs:0, wickets:0, maidens:0, name: ball.bowlerName };
                
                const striker = state.batsmen[ball.strikerId];
                const bowler = state.bowlers[ball.bowlerId];
                
                let totalRuns = ball.runs;
                let batRuns = ball.runs;
                let isLegal = true;

                if (ball.extrasType) {
                    totalRuns += (ball.extrasRuns || 0);
                    if(ball.extrasType === 'WD' || ball.extrasType === 'NB') { 
                        isLegal = false; 
                        batRuns = (ball.extrasType === 'NB') ? ball.runs : 0;
                    } else { batRuns = 0; }
                }

                s.runs += totalRuns;
                currentOverRuns += totalRuns;

                if(striker) {
                    striker.runs += batRuns;
                    if(isLegal) striker.balls++;
                    if(batRuns === 4) striker.fours++;
                    if(batRuns === 6) striker.sixes++;
                }
                if(bowler) {
                    bowler.runs += totalRuns;
                    if(ball.extrasType === 'LB' || ball.extrasType === 'BY') bowler.runs -= totalRuns; 
                    if(isLegal) bowler.balls++;
                    if(ball.isWicket && ball.wicketType !== 'runout') bowler.wickets++;
                }

                if(isLegal) {
                    s.balls++;
                    state.totalLegalBalls++; 
                    if(s.balls === 6) { 
                        s.overs++; s.balls = 0; 
                        s.runPerOver.push(currentOverRuns);
                        currentOverRuns = 0;
                    }
                }

                if(ball.isWicket) {
                    s.wickets++;
                    if(state.batsmen[ball.wicketVictimId || ball.strikerId]) {
                        state.batsmen[ball.wicketVictimId || ball.strikerId].out = ball.wicketType;
                    }
                    
                    const victimId = ball.wicketVictimId || ball.strikerId;
                    const victimName = state.batsmen[victimId]?.name || "Batsman";
                    const victimRuns = state.batsmen[victimId]?.runs || 0;
                    const bowlerName = ball.bowlerName || "Bowler";

                    s.wicketsData.push({ 
                        x: s.overs + (s.balls/6), 
                        y: s.runs,
                        player: victimName,
                        pRuns: victimRuns,
                        wicketNo: s.wickets,
                        bowler: bowlerName
                    });

                    lastWicketScore = s.runs;
                    lastWicketBalls = state.totalLegalBalls;
                }

                ball.overStr = `${s.overs}.${s.balls}`;
                state.timeline.unshift(ball);

                if(isLegal && (s.balls === 0 || index === history.length -1)) {
                    s.history.push({ over: s.overs + (s.balls/6), runs: s.runs });
                }
            });

            const currentInnState = state.innings[state.currentInnings];
            state.currentPartnership.runs = currentInnState.runs - lastWicketScore;
            state.currentPartnership.balls = state.totalLegalBalls - lastWicketBalls;
            if(state.currentPartnership.runs < 0) state.currentPartnership.runs = 0; 

            if(history.length > 0 && currentMatchId === matchData.id) {
                const lastBall = history[history.length - 1];
                
                if (isViewJustOpened) {
                    lastProcessedBallId = lastBall.id;
                } else if(lastBall.id > lastProcessedBallId) {
                    lastProcessedBallId = lastBall.id;
                    triggerEventEffects(lastBall);
                    handleRunAnimation(lastBall, state.currentInnings);
                }
            }

            return state;
        }

        // --- EFFECTS SYSTEM ---
        function triggerEventEffects(ball) {
            try {
                batHitSound.currentTime = 0;
                batHitSound.volume = 0.5;
                batHitSound.play().catch(e => console.log("Audio autoplay blocked"));
            } catch(e) {}

            if(ball.runs === 6 || ball.runs === 4 || ball.isWicket) {
                const overlay = document.getElementById('eventOverlay');
                const mainTxt = document.getElementById('eventText');
                const subTxt = document.getElementById('eventSub');
                
                overlay.classList.remove('opacity-0', 'pointer-events-none');
                overlay.classList.add('active');
                
                if(ball.runs === 6) {
                    mainTxt.innerText = "6"; mainTxt.style.background = "linear-gradient(to bottom, #4ade80, #16a34a)"; mainTxt.style.webkitBackgroundClip = "text";
                    subTxt.innerText = "বিশাল ছক্কা!";
                    confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 }, colors: ['#4ade80', '#22c55e'] });
                } else if (ball.runs === 4) {
                    mainTxt.innerText = "4"; mainTxt.style.background = "linear-gradient(to bottom, #60a5fa, #2563eb)"; mainTxt.style.webkitBackgroundClip = "text";
                    subTxt.innerText = "বাউন্ডারি!";
                    confetti({ particleCount: 100, spread: 60, origin: { y: 0.6 }, colors: ['#60a5fa', '#2563eb'] });
                } else if (ball.isWicket) {
                    mainTxt.innerText = "Out"; mainTxt.style.background = "linear-gradient(to bottom, #f87171, #dc2626)"; mainTxt.style.webkitBackgroundClip = "text";
                    subTxt.innerText = "উইকেট পতন";
                }

                setTimeout(() => {
                    overlay.classList.add('opacity-0', 'pointer-events-none');
                    overlay.classList.remove('active');
                }, 1000);
            }
        }

        function handleRunAnimation(ball, innings) {
            const totalRuns = ball.runs + (ball.extrasRuns || 0);
            if(totalRuns === 0 && !ball.isWicket) return; 

            const targetId = innings === 1 ? 'teamAScore' : 'teamBScore';
            const targetEl = document.getElementById(targetId);
            if(!targetEl) return;

            const rect = targetEl.getBoundingClientRect();
            const targetX = rect.left + rect.width / 2;
            const targetY = rect.top + rect.height / 2;

            const startX = window.innerWidth / 2;
            const startY = window.innerHeight / 2 + 80;

            const el = document.createElement('div');
            el.className = 'flying-run-indicator text-4xl';
            let txt = `+${totalRuns}`;
            if(ball.isWicket && totalRuns === 0) txt = "W";
            else if(ball.isWicket) txt = `W+${totalRuns}`;
            
            el.innerHTML = txt;
            
            if(ball.isWicket) el.classList.add('text-red-500');
            else if(totalRuns >= 4) el.classList.add('text-green-500');
            else el.classList.add('text-gray-800', 'dark:text-white');
            
            el.style.left = `${startX}px`;
            el.style.top = `${startY}px`;
            el.style.transform = 'translate(-50%, -50%) scale(0)';
            
            document.body.appendChild(el);

            const animation = el.animate([
                { transform: 'translate(-50%, -50%) scale(0.5)', opacity: 0, offset: 0 },
                { transform: 'translate(-50%, -50%) scale(2.5)', opacity: 1, offset: 0.2 }, 
                { transform: `translate(${targetX - startX}px, ${targetY - startY}px) scale(0.5)`, opacity: 1, offset: 0.8 }, 
                { transform: `translate(${targetX - startX}px, ${targetY - startY}px) scale(0.2)`, opacity: 0, offset: 1 } 
            ], {
                duration: 900,
                easing: 'cubic-bezier(0.25, 1, 0.5, 1)',
                fill: 'forwards'
            });

            animation.onfinish = () => {
                el.remove();
                targetEl.classList.remove('score-impact-anim');
                void targetEl.offsetWidth; 
                targetEl.classList.add('score-impact-anim');
            };
        }

        function getBengaliComm(ball) {
            const bowler = ball.bowlerName;
            const batter = ball.strikerName;
            
            if (ball.isWicket) return `<span class="text-red-600 font-bold">আউট!</span> ${bowler} এর বলে ${batter} ফিরে গেলেন প্যাভিলিয়নে। (${ball.wicketType})`;
            if (ball.runs === 6) return `<span class="text-green-600 font-bold">বিশাল ছক্কা!</span> ${batter} বলটি উড়িয়ে মারলেন সীমানার বাইরে!`;
            if (ball.runs === 4) return `<span class="text-blue-600 font-bold">চার!</span> ${batter} এর ব্যাটে দুর্দান্ত শট।`;
            if (ball.runs === 1) return `এক রান নিলেন ${batter}।`;
            if (ball.runs === 2) return `দুই রান নিলেন ${batter}।`;
            if (ball.runs === 0) return `ডট বল। সুন্দর ডেলিভারি ${bowler} এর।`;
            if (ball.extrasType) return `অতিরিক্ত রান (${ball.extrasType})।`;
            return `${ball.runs} রান।`;
        }

        // --- UI UPDATE ---
        function updateUI(match, state) {
            const i1 = state.innings[1]; const i2 = state.innings[2];
            document.getElementById('teamAName').innerText = match.teamAName;
            document.getElementById('teamBName').innerText = match.teamBName;
            document.getElementById('matchTournamentName').innerText = match.tournamentName || 'Match Center';
            document.getElementById('matchResult').innerText = match.result || (match.status === 'live' ? 'খেলা চলছে' : 'ফলাফল বাকি');
            
            const badge = document.getElementById('matchStatusBadge');
            if(match.status === 'live') {
                badge.className = "bg-red-500 text-white text-[10px] px-2.5 py-1 rounded-md uppercase font-bold tracking-wider shadow-sm animate-pulse";
                badge.innerText = "সরাসরি";
            } else {
                badge.className = "bg-gray-500 text-white text-[10px] px-2.5 py-1 rounded-md uppercase font-bold tracking-wider shadow-sm";
                badge.innerText = "সমাপ্ত";
            }

            document.getElementById('teamAScore').innerText = `${i1.runs}/${i1.wickets}`;
            document.getElementById('teamAOvers').innerText = `${i1.overs}.${i1.balls} ov`;

            const targetEl = document.getElementById('matchTargetDisplay');
            const winProbEl = document.getElementById('winProbContainer');
            const partEl = document.getElementById('partnershipDisplay');

            if(match.status === 'live') {
                partEl.classList.remove('hidden');
                document.getElementById('partnerRuns').innerText = state.currentPartnership.runs;
                document.getElementById('partnerBalls').innerText = state.currentPartnership.balls;
            } else {
                partEl.classList.add('hidden');
            }

            if(match.currentInnings === 2 || match.status === 'completed') {
                document.getElementById('teamBScore').innerText = `${i2.runs}/${i2.wickets}`;
                document.getElementById('teamBOvers').innerText = `${i2.overs}.${i2.balls} ov`;
                
                const target = i1.runs + 1;
                targetEl.classList.remove('hidden');
                targetEl.innerText = `লক্ষ্য: ${target}`;
                
                if(match.status === 'live') {
                    winProbEl.classList.remove('hidden');
                    const need = target - i2.runs;
                    const remBalls = (match.oversLimit*6) - ((i2.overs*6)+i2.balls);
                    const rrr = remBalls > 0 ? need/(remBalls/6) : 99;
                    let probA = 50;
                    if(rrr > 10) probA = 80; else if(rrr > 8) probA = 60; else if(rrr < 6) probA = 30;
                    document.getElementById('winBarA').style.width = `${probA}%`;
                    document.getElementById('winBarB').style.width = `${100-probA}%`;
                } else {
                    winProbEl.classList.add('hidden');
                }
            } else {
                 document.getElementById('teamBScore').innerText = "ব্যাট করেনি";
                 document.getElementById('teamBOvers').innerText = "";
                 targetEl.classList.add('hidden');
                 winProbEl.classList.add('hidden');
            }

            const ballCont = document.getElementById('recentBallsContainer');
            ballCont.innerHTML = '';
            state.timeline.slice(0, 15).forEach(b => {
                let bg = "bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300";
                let txt = b.runs;
                if(b.isWicket) { bg = "bg-red-500 text-white shadow-red-500/50"; txt = "W"; }
                else if(b.runs === 4) { bg = "bg-blue-500 text-white shadow-blue-500/50"; }
                else if(b.runs === 6) { bg = "bg-green-500 text-white shadow-green-500/50"; }
                else if(b.extrasType) { bg = "bg-yellow-100 dark:bg-yellow-900/50 text-yellow-600"; txt = b.extrasType; }
                ballCont.innerHTML += `<div class="ball-circle ${bg} flex-shrink-0 snap-start">${txt}</div>`;
            });

            renderScorecardTable(match.squadA, state, 'live-content-teamA', match);
            renderScorecardTable(match.squadB, state, 'live-content-teamB', match);
            
            const commFeed = document.getElementById('commFeed');
            commFeed.innerHTML = '';
            state.timeline.slice(0, 20).forEach(b => {
                let border = "border-l-2 border-gray-300 dark:border-gray-600";
                if(b.isWicket) border = "border-l-4 border-red-500";
                else if(b.runs === 4 || b.runs === 6) border = "border-l-4 border-green-500";

                commFeed.innerHTML += `
                    <div class="pl-4 relative ${border} py-2">
                        <div class="flex justify-between items-center text-xs text-gray-400 mb-1">
                            <span>ওভার ${b.overStr}</span>
                            <span class="font-bold text-gray-600 dark:text-gray-300">${b.bowlerName} টু ${b.strikerName}</span>
                        </div>
                        <p class="text-sm font-medium text-gray-800 dark:text-gray-200">
                             ${getBengaliComm(b)}
                        </p>
                    </div>
                `;
            });
            
            if(match.status === 'live') {
                const curInn = state.innings[state.currentInnings];
                const ballsDone = (curInn.overs*6) + curInn.balls;
                const crr = ballsDone > 0 ? (curInn.runs / ballsDone) * 6 : 0;
                document.getElementById('anaCRR').innerText = crr.toFixed(2);
                document.getElementById('anaProj').innerText = Math.round(crr * 20); 
            }

            if(document.getElementById('content-analytics').classList.contains('hidden') === false) {
                 renderCharts(state);
            }
        }

        function renderScorecardTable(squad, state, elId, match) {
            if(!squad) return;
            const container = document.getElementById(elId);
            let html = `<table class="w-full text-sm border-collapse">
                <thead><tr class="text-gray-400 text-xs border-b border-gray-200 dark:border-gray-700"><th class="text-left py-2 font-medium">ব্যাটার</th><th class="text-right py-2 font-medium">R</th><th class="text-right py-2 font-medium">B</th><th class="text-right py-2 font-medium">4s</th><th class="text-right py-2 font-medium">6s</th><th class="text-right py-2 font-medium">SR</th></tr></thead>
                <tbody>`;
            
            // Filter players who have batted or are currently batting
            let batsmenList = squad.filter(p => state.batsmen[p.id] || p.id === match.currentStrikerId || p.id === match.currentNonStrikerId);
            
            // SORTING LOGIC: Striker -> NonStriker -> Others
            batsmenList.sort((a, b) => {
                if (a.id === match.currentStrikerId) return -1;
                if (b.id === match.currentStrikerId) return 1;
                if (a.id === match.currentNonStrikerId) return -1;
                if (b.id === match.currentNonStrikerId) return 1;
                return 0; 
            });

            batsmenList.forEach(p => {
                const s = state.batsmen[p.id];
                // Note: The filter above ensures we only get relevant players, but double checking s exists for stats
                const isStriker = p.id === match.currentStrikerId;
                const isNonStriker = p.id === match.currentNonStrikerId;
                const runs = s ? s.runs : 0;
                const balls = s ? s.balls : 0;
                const sr = balls > 0 ? ((runs/balls)*100).toFixed(0) : 0;
                
                let rowClass = "border-b border-gray-100 dark:border-gray-700/50";
                let nameColor = "text-gray-800 dark:text-gray-200";
                let icon = "";
                
                // Modified OUT styling: Removed line-through, kept red color
                if(s && s.out) { nameColor = "text-red-500 font-medium opacity-90"; } 
                else if (isStriker) { rowClass += " bg-green-50 dark:bg-green-900/10"; nameColor = "text-green-600 dark:text-green-400 font-bold"; icon="🏏"; }
                else if (isNonStriker) { rowClass += " bg-green-50/50 dark:bg-green-900/5"; nameColor = "text-green-600 dark:text-green-400"; }

                html += `<tr class="${rowClass}">
                    <td class="py-3 ${nameColor}">${p.name} ${icon} <div class="text-[10px] text-gray-400 font-normal">${s && s.out ? s.out : ''}</div></td>
                    <td class="text-right font-bold dark:text-gray-100">${runs}</td>
                    <td class="text-right text-gray-500">${balls}</td>
                    <td class="text-right text-gray-400">${s?.fours||0}</td>
                    <td class="text-right text-gray-400">${s?.sixes||0}</td>
                    <td class="text-right text-xs text-gray-500">${sr}</td>
                </tr>`;
            });
            html += `</tbody></table>`;
            
            // --- NEW: Yet to Bat Section ---
            let yetToBatList = squad.filter(p => !state.batsmen[p.id] && p.id !== match.currentStrikerId && p.id !== match.currentNonStrikerId);
            if(yetToBatList.length > 0) {
                 const names = yetToBatList.map(p => p.name).join(', ');
                 html += `<div class="mt-3 px-3 py-2 bg-gray-50 dark:bg-gray-700/20 rounded-lg text-xs border border-gray-100 dark:border-gray-700/30">
                    <span class="font-bold text-gray-500 dark:text-gray-400 uppercase tracking-wide">ব্যাট করেননি:</span> 
                    <span class="text-gray-600 dark:text-gray-300 ml-1 leading-relaxed">${names}</span>
                </div>`;
            }

            html += `<h5 class="mt-4 mb-2 text-xs font-bold text-gray-400 uppercase">বোলার</h5>
            <table class="w-full text-sm border-collapse">
                <thead><tr class="text-gray-400 text-xs border-b border-gray-200 dark:border-gray-700"><th class="text-left py-2 font-medium">বোলার</th><th class="text-right py-2 font-medium">O</th><th class="text-right py-2 font-medium">M</th><th class="text-right py-2 font-medium">R</th><th class="text-right py-2 font-medium">W</th><th class="text-right py-2 font-medium">Eco</th></tr></thead>
                <tbody>`;
            
            // Filter bowlers who have bowled
            let bowlersList = squad.filter(p => state.bowlers[p.id]);

            // SORTING LOGIC: Current Bowler -> Others
            bowlersList.sort((a, b) => {
                if (a.id === match.currentBowlerId) return -1;
                if (b.id === match.currentBowlerId) return 1;
                return 0;
            });

            bowlersList.forEach(p => {
                const s = state.bowlers[p.id];
                if(s) {
                    const overs = Math.floor(s.balls/6) + '.' + (s.balls%6);
                    const eco = s.balls > 0 ? ((s.runs/s.balls)*6).toFixed(1) : 0;
                    const isCurrent = p.id === match.currentBowlerId;
                    
                    html += `<tr class="border-b border-gray-100 dark:border-gray-700/50 ${isCurrent ? 'bg-blue-50 dark:bg-blue-900/10' : ''}">
                        <td class="py-2.5 ${isCurrent ? 'text-blue-600 dark:text-blue-400 font-bold' : 'text-gray-800 dark:text-gray-200'}">${p.name} ${isCurrent?'⚾':''}</td>
                        <td class="text-right dark:text-gray-300">${overs}</td>
                        <td class="text-right text-gray-400">${s.maidens}</td>
                        <td class="text-right dark:text-gray-300">${s.runs}</td>
                        <td class="text-right font-bold text-gray-800 dark:text-white">${s.wickets}</td>
                        <td class="text-right text-xs text-gray-500">${eco}</td>
                    </tr>`;
                }
            });

            html += `</tbody></table>`;
            container.innerHTML = html;
        }

        // --- CHARTS ---
        function renderCharts(state) {
            const ctxWorm = document.getElementById('wormChart');
            const ctxBar = document.getElementById('barChart');
            
            // Prepare Data for Worm Chart
            const d1 = state.innings[1].history.map(h => ({x: h.over, y: h.runs}));
            const d2 = state.innings[2].history.map(h => ({x: h.over, y: h.runs}));
            const w1 = state.innings[1].wicketsData;
            const w2 = state.innings[2].wicketsData;

            if(ctxWorm) {
                if (wormChartInstance) {
                    // Update existing instance data
                    wormChartInstance.data.datasets[0].data = d1;
                    wormChartInstance.data.datasets[1].data = d2;
                    wormChartInstance.data.datasets[2].data = w1;
                    wormChartInstance.data.datasets[3].data = w2;
                    wormChartInstance.update('none'); // Efficient update without full re-render animation
                } else {
                    // Create new instance
                    wormChartInstance = new Chart(ctxWorm, {
                        type: 'line',
                        data: {
                            datasets: [
                                { 
                                    label: '১ম ইনিংস', 
                                    data: d1, 
                                    borderColor: '#10b981', 
                                    tension: 0.4, 
                                    pointRadius: 0, 
                                    borderWidth: 2 
                                },
                                { 
                                    label: '২য় ইনিংস', 
                                    data: d2, 
                                    borderColor: '#f59e0b', 
                                    tension: 0.4, 
                                    pointRadius: 0, 
                                    borderWidth: 2 
                                },
                                // Wicket Scatter Points
                                {
                                    label: 'উইকেট (১ম)',
                                    data: w1,
                                    type: 'scatter',
                                    pointStyle: 'circle',
                                    pointRadius: 6,
                                    pointHoverRadius: 8,
                                    backgroundColor: 'white',
                                    borderColor: '#10b981',
                                    borderWidth: 2,
                                    showLine: false
                                },
                                {
                                    label: 'উইকেট (২য়)',
                                    data: w2,
                                    type: 'scatter',
                                    pointStyle: 'circle',
                                    pointRadius: 6,
                                    pointHoverRadius: 8,
                                    backgroundColor: 'white',
                                    borderColor: '#f59e0b',
                                    borderWidth: 2,
                                    showLine: false
                                }
                            ]
                        },
                        options: {
                            responsive: true, maintainAspectRatio: false,
                            plugins: { 
                                legend: { display: true, labels: { color: '#9ca3af', font: {size: 10} } },
                                tooltip: {
                                    backgroundColor: 'rgba(15, 23, 42, 0.9)',
                                    titleColor: '#10b981',
                                    bodyColor: '#fff',
                                    borderColor: 'rgba(255,255,255,0.1)',
                                    borderWidth: 1,
                                    padding: 10,
                                    cornerRadius: 8,
                                    displayColors: false,
                                    callbacks: {
                                        label: function(context) {
                                            const point = context.raw;
                                            if(point.player) { // It's a wicket point
                                            return [
                                                `🔴 উইকেট: ${point.wicketNo}`,
                                                `ব্যাটসম্যান: ${point.player} (${point.pRuns})`,
                                                `বোলার: ${point.bowler}`,
                                                `দলীয় স্কোর: ${point.y}`
                                            ];
                                            }
                                            return `ওভার: ${context.parsed.x.toFixed(1)}, রান: ${context.parsed.y}`;
                                        }
                                    }
                                }
                            },
                            scales: {
                                x: { 
                                    type: 'linear', // Required for mixing line and scatter accurately
                                    grid: { display: false, color: '#374151' }, 
                                    ticks: { color: '#9ca3af', stepSize: 5 } 
                                },
                                y: { grid: { color: '#374151', display: false }, ticks: { color: '#9ca3af' } }
                            }
                        }
                    });
                }
            }

            // Prepare Bar Chart Data
            const rpo1 = state.innings[1].runPerOver;
            const labels = rpo1.map((_, i) => i + 1);

            if(ctxBar) {
                if (barChartInstance) {
                    // Update existing instance data
                    barChartInstance.data.labels = labels;
                    barChartInstance.data.datasets[0].data = rpo1;
                    barChartInstance.update('none');
                } else {
                    // Create new instance
                    barChartInstance = new Chart(ctxBar, {
                        type: 'bar',
                        data: {
                            labels: labels,
                            datasets: [{
                                label: 'রান প্রতি ওভার',
                                data: rpo1,
                                backgroundColor: '#6366f1',
                                borderRadius: 4
                            }]
                        },
                        options: {
                            responsive: true, maintainAspectRatio: false,
                            scales: {
                                y: { beginAtZero: true, grid: { color: '#374151' } },
                                x: { grid: { display: false } }
                            }
                        }
                    });
                }
            }
        }

        // --- PLAYER STATS LOGIC ---
        window.loadAllPlayers = async () => {
             const list = document.getElementById('playersListContainer');
             list.innerHTML = `<div class="col-span-full flex justify-center py-10"><div class="animate-spin rounded-full h-8 w-8 border-b-2 border-green-500"></div></div>`;
             
             try {
                const q = query(collection(db, getCollPath('players')), orderBy('totalRuns', 'desc'));
                const snap = await getDocs(q);
                list.innerHTML = '';
                window.allPlayersData = {}; 

                snap.forEach(doc => {
                    const p = doc.data();
                    window.allPlayersData[doc.id] = p;
                    const initial = p.name.charAt(0);
                    
                    list.innerHTML += `
                        <div class="glass-card rounded-xl p-4 flex items-center gap-4 cursor-pointer hover:bg-white/50 dark:hover:bg-gray-700/50 transition border border-transparent hover:border-green-500/30" onclick="openPlayerModal('${doc.id}')">
                            <div class="w-12 h-12 rounded-full bg-gradient-to-br from-gray-200 to-gray-300 dark:from-gray-700 dark:to-gray-800 flex items-center justify-center font-bold text-gray-500 dark:text-gray-300 shadow-inner">
                                ${p.imageUrl ? `<img src="${p.imageUrl}" class="w-full h-full rounded-full object-cover">` : initial}
                            </div>
                            <div>
                                <h4 class="font-bold text-gray-800 dark:text-gray-100 font-display text-lg">${p.name}</h4>
                                <div class="flex gap-2 text-xs mt-1">
                                    <span class="bg-emerald-100 dark:bg-emerald-900/30 text-emerald-600 dark:text-emerald-400 px-2 py-0.5 rounded font-medium">Runs: ${p.totalRuns||0}</span>
                                    <span class="bg-indigo-100 dark:bg-indigo-900/30 text-indigo-600 dark:text-indigo-400 px-2 py-0.5 rounded font-medium">Wkts: ${p.totalWickets||0}</span>
                                </div>
                            </div>
                        </div>
                    `;
                });
             } catch(e) { console.log(e); }
        };

        window.filterPlayers = () => {
            const term = document.getElementById('playerSearch').value.toLowerCase();
            const cards = document.querySelectorAll('#playersListContainer > div');
            cards.forEach(card => {
                const name = card.querySelector('h4').innerText.toLowerCase();
                card.style.display = name.includes(term) ? 'flex' : 'none';
            });
        };

        window.openPlayerModal = (id) => {
            const p = window.allPlayersData[id];
            if(!p) return;
            
            document.getElementById('modalName').innerText = p.name;
            document.getElementById('modalId').innerText = `ID: ${id}`;
            const av = document.getElementById('modalAvatar');
            if(p.imageUrl) av.innerHTML = `<img src="${p.imageUrl}" class="w-full h-full object-cover">`;
            else av.innerText = p.name.charAt(0);
            
            document.getElementById('mRuns').innerText = p.totalRuns || 0;
            document.getElementById('mBalls').innerText = p.totalBalls || 0;
            document.getElementById('mHS').innerText = p.highScore || 0;
            const sr = p.totalBalls > 0 ? ((p.totalRuns/p.totalBalls)*100).toFixed(2) : '0.00';
            document.getElementById('mSR').innerText = sr;
            
            document.getElementById('mWickets').innerText = p.totalWickets || 0;
            const overs = Math.floor((p.totalOversBalls||0)/6) + '.' + ((p.totalOversBalls||0)%6);
            document.getElementById('mOvers').innerText = overs;
            const eco = (p.totalOversBalls||0) > 0 ? ((p.totalRunsConceded||0)/(p.totalOversBalls)*6).toFixed(2) : '0.00';
            document.getElementById('mEco').innerText = eco;
            document.getElementById('mBest').innerText = p.bestBowling || '-/-';

            const modal = document.getElementById('playerModal');
            const content = document.getElementById('modalContent');
            const overlay = document.getElementById('modalOverlay');
            
            modal.classList.remove('invisible');
            modal.classList.remove('pointer-events-none');
            overlay.classList.remove('opacity-0');
            content.classList.remove('translate-y-full');
        };

        window.closePlayerModal = () => {
            const modal = document.getElementById('playerModal');
            const content = document.getElementById('modalContent');
            const overlay = document.getElementById('modalOverlay');
            
            content.classList.add('translate-y-full');
            overlay.classList.add('opacity-0');
            setTimeout(() => {
                modal.classList.add('pointer-events-none');
                modal.classList.add('invisible');
            }, 300);
        };

        window.switchLiveTab = (team) => {
            const btnA = document.getElementById('btn-teamA');
            const btnB = document.getElementById('btn-teamB');
            const conA = document.getElementById('live-content-teamA');
            const conB = document.getElementById('live-content-teamB');
            
            if(team === 'teamA') {
                btnA.className = "flex-1 py-1.5 text-xs font-bold rounded-md bg-white dark:bg-gray-600 shadow-sm text-gray-800 dark:text-white transition-all";
                btnB.className = "flex-1 py-1.5 text-xs font-bold rounded-md text-gray-500 hover:bg-gray-200 dark:hover:bg-gray-600 transition-all";
                conA.classList.remove('hidden'); conB.classList.add('hidden');
            } else {
                btnB.className = "flex-1 py-1.5 text-xs font-bold rounded-md bg-white dark:bg-gray-600 shadow-sm text-gray-800 dark:text-white transition-all";
                btnA.className = "flex-1 py-1.5 text-xs font-bold rounded-md text-gray-500 hover:bg-gray-200 dark:hover:bg-gray-600 transition-all";
                conB.classList.remove('hidden'); conA.classList.add('hidden');
            }
        };

    </script>
</body>
</html>